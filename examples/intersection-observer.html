<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>content-visibility fade test</title>
<style>
body {
    margin: 0;
    height: 300vh;
    font-family: sans-serif;
    background: #f0f0f0;
}

h1 {
    text-align: center;
}

.spacer {
    height: 150vh;
}

.fade-box {
    content-visibility: auto;
    contain-intrinsic-size: 200px;
    width: 150px;
    height: 150px;
    background: rgb(255, 59, 48);
    margin: 0 auto;
    transition: width 1s ease;
}

.fade-box.visible {
    width: 300px;
}
</style>
</head>
<body>
    <h1>Scroll down</h1>
    <div class="spacer"></div>
    <div id="box" class="fade-box"></div>
    <div class="spacer"></div>

    <script>
    const box = document.getElementById("box");
    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting)
              box.classList.add("visible");
            else
              box.classList.remove("visible");
        });
    });

    observer.observe(box);
    </script>
</body>
</html>