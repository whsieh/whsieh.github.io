<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
<style>
body, html {
    font-family: system-ui;
    font-size: 16px;
}

table {
    border-collapse: collapse;
    min-width: 250px;
    max-width: 400px;
}

th, td {
    padding: 0.5em;
    border: 1px solid #DDD;
}

tr:nth-child(even) {
    background-color: #EFEFEF;
}

.container {
    margin: 1em;
}

label {
    margin-left: 2px;
}

div#hidden-editor {
    opacity: 0;
    position: fixed;
    top: -1000px;
    left: -1000px;
    width: 0.5px;
    height: 0.5px;
}

button, .text-display {
    font-size: 16px;
}
</style>
<script>
let startTime;

function makeRow(event) {
    const row = document.createElement("tr");
    const timeData = document.createElement("td");
    const typeData = document.createElement("td");
    const keyData = document.createElement("td");
    const currentTime = (new Date).getTime();
    if (!startTime)
        startTime = currentTime;
    timeData.textContent = currentTime - startTime;
    typeData.textContent = event.type;
    keyData.textContent = event.key;
    row.appendChild(timeData);
    row.appendChild(typeData);
    row.appendChild(keyData);
    return row;
}

function handleKeyEventByAppendingRow(event) {
    let shouldPreventDefault = document.getElementById("toggle-prevent-default");
    if (shouldPreventDefault.checked)
        event.preventDefault();
    const tableBody = document.querySelector("tbody");
    tableBody.appendChild(makeRow(event));
}

addEventListener("load", () => {
    let editor = document.getElementById("hidden-editor");
    let textDisplay = document.querySelector(".text-display");

    document.body.addEventListener("keydown", handleKeyEventByAppendingRow);
    document.body.addEventListener("keypress", handleKeyEventByAppendingRow);
    document.body.addEventListener("keyup", handleKeyEventByAppendingRow);

    document.querySelector(".reset-button").addEventListener("mousedown", event => {
        const tableBody = document.querySelector("tbody");
        for (let row of [...tableBody.querySelectorAll("tr")]) {
            if (!row.classList.contains("header"))
                row.remove();
        }
        event.preventDefault();
        textDisplay.value = "";
        editor.textContent = "";
    });

    document.querySelector(".focus-button").addEventListener("click", event => {
        editor.innerHTML = "";
        editor.focus();
        event.preventDefault();
    });

    editor.addEventListener("input", () => {
        textDisplay.value = editor.textContent;
    });
});
</script>
</head>
<body>
<div class="container">
    <button class="reset-button">Reset</button>
    <button class="focus-button">Focus Editor</button>
</div>
<div class="container">
    <input class="text-display" readonly placeholder="No text in hidden editor">
</div>
<div class="container">
    <input type="checkbox" id="toggle-prevent-default"><label for="toggle-prevent-default">preventDefault()</label>
</div>
<table>
    <tbody>
        <tr class="header">
            <th>Time (ms)</th>
            <th>Type</th>
            <th>Key</th>
        </tr>
    </tbody>
</table>
<div id="hidden-editor" contenteditable></div>
</body>
</html>