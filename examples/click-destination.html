<!DOCTYPE html>
<html>
<head>
<meta charset="utf8">
<style>
body, html {
    font-size: 16px;
    font-family: system-ui;
}

button, input, label {
    font-size: 20px;
}

input {
    width: 100px;
}

div + div {
    margin-top: 1em;
}
</style>
</head>
<body>
<div>
    <label for="trigger">Trigger: </label>
    <input id="trigger" type="number" value="12" max="15" min="0"></input>
</div>
<div>
    <label for="priority">Priority: </label>
    <input id="priority" type="number" value="4" max="63" min="0"></input>
</div>
<div>
    <button id="buy">Buy it now!</button>
</div>
<div>
    <strong>Response status:</strong>&nbsp;<span id="response-status">--</span>
</div>
<script>
let triggerInput = document.querySelector("#trigger");
let priorityInput = document.querySelector("#priority");
let buyButton = document.querySelector("#buy");
let responseStatus = document.querySelector("#response-status");

function priorityValue() {
    let result = priorityInput.valueAsNumber;
    return isNaN(result) ? 0 : result;
}

function triggerValue() {
    let result = triggerInput.valueAsNumber;
    return isNaN(result) ? 0 : result;
}

buyButton.addEventListener("click", async () => {
    const query = `trigger=${triggerValue()}&time=${(new Date).getTime()}&priority=${priorityValue()}`;
    let result = await fetch("https://pcm-test-server.herokuapp.com/pixel?" + query);
    responseStatus.textContent = result.status;
});
</script>
</body>
</html>
