<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>content-visibility fade test</title>
<style>
body {
    margin: 0;
    font-family: sans-serif;
    background: #f0f0f0;
}

h1 {
    text-align: center;
}

.spacer {
    height: 10vh;
}

.fade-box-wrapper {
    content-visibility: auto;
    contain-intrinsic-size: 150px;
}

.fade-box {
    content-visibility: auto;
    contain-intrinsic-size: 150px;
    width: 150px;
    height: 150px;
    background: rgb(255, 59, 48);
    margin: 0 auto;
    transition: width 1s ease;
    font-size: 24px;
    color: white;
    line-height: 150px;
    text-align: center;
    border-radius: 1em;
}

.fade-box.visible {
    width: calc(min(75vw, 600px));
}
</style>
</head>
<body>
    <h1>Scroll down</h1>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box01" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box02" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box03" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box04" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box05" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box06" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box07" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box08" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box09" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box10" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box11" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box12" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box13" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box14" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box15" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box16" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box17" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box18" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box19" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box20" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box21" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box22" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box23" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box24" class="fade-box"></div>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="fade-box-wrapper">
        <div class="fade-box-wrapper">
            <div id="box25" class="fade-box"></div>
        </div>
    </div>
    <script>
    for (const box of [...document.querySelectorAll(".fade-box")]) {
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting)
                  box.classList.add("visible");
                else
                  box.classList.remove("visible");
            });
        });
        observer.observe(box);
        box.textContent = box.id;
    }
    </script>
</body>
</html>